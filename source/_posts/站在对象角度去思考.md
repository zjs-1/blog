---
title: 站在对象的角度去思考
date: 2018-11-11 00:43:46
tags: [领域驱动设计,面向对象]
categories: 技术
---

## 前言

> 一开始想写这篇博客的时候，想到的名字就是`站在对象的角度去思考`，不过想了想，叫`面向对象`更专业吧，可是又显得太程序化了，还是叫这个吧。

本来是想等看完、理解透`领域驱动设计`，再来写一篇博客说说自己的理解的，但是发现遥遥无期。最近正好接触到一个概念:`最小可行性方案`，与其等全部看完再来写感悟，倒不如有感便发，效果明显，积少成多。

## 情景一: 面向过程的产品经理

前天，产品经理A找到我说，想在新建`试卷任务`的地方，加一个按钮，点击之后跳转到`推送`界面，然后自动帮`助教`选上拥有对应`题库分类`的`课程`，便于推送。

一通描述下来，我是懵逼的，看起来一切正常，但是又感觉哪里不对，细细一想便看出其中问题。

先把上面这个需求里的对象提取出来: 试卷任务、推送、课程、题库分类、助教，然后看下他们之间的关系:
![](http://cdn.jsblog.site/15418700508715.jpg)

助教作为用户，不做考虑，其他对象的简化关系图大概如上面，看起来试卷任务和试卷推送的确存在某些关联，产品提的实现方式似乎值得考虑？

再仔细看看产品所说的，其实他所关注的关联点不在红色这条虚线，而在蓝色的虚线，他不过是通过`试卷任务`与`试卷推送`之前这微妙的关系，把课程和推送关联了起来。

我觉得这应该算是一种面向过程的思考方式: 建试卷任务之后需要做试卷推送，那就去取试卷任务的题库分类，找到对应的课程，再去给对应的课程进行推送。

这样存在什么问题呢？我也说不清，从直觉来看，这东西就不科学。

最后我提出的解决方案是什么，建试卷任务的时候，创建试卷推送，推给拥有对应任务的学员。在这基础上，把范围扩大，建任何一种类型的任务时，都创建对应的任务推送，这个样子就把推送跟任务联系在了一起。最终这个方案也得到产品和助教的同意。

至于我是怎么得出这个解决方案的，一个是对业务的了解，一个便是站在对象的角度，思考对象间的关系。比如我想的是`试卷任务`和`试卷推送`这两个对象之间到底是什么关系，能够怎么样关联，而不是，我该怎么去建`试卷任务`然后再去建`试卷推送`能够快捷点。

## 情景二: 混淆对象的产品经理

还是产品经理A，前阵子给了我一个原型图，简化版的需求大概是这样子: 用户要选择某个跳转对象，其中跳转对象包含以下几种，`普通课程``课程分类``链接`。他给的交互图是这样子的:
![](http://cdn.jsblog.site/15418711590336.jpg)

粗看之下还好，但是仔细看了描述之后发现，有个地方让我再次懵逼: 
1. 如果你要选择`普通课程`类型，一级菜单要选择`普通课程`，二级菜单要选择具体某个`课程分类`，出现三级菜单，要选择具体某个`课程`。
2. 如果你要选择`课程分类`类型，一级菜单要选择`普通课程`，二级菜单要选择具体某个`课程分类`，出现三级菜单，但是别选具体`课程`。

看起来交互好像也没有问题，能够完成功能。这里让我懵逼的地方在于，为什么不单独把课程分类拿出来，作为一个完整的一级菜单呢，合并到`普通课程`下面，对于开发和用户而言，都不算是一个完美的选择。

究其原因，我觉得还是没站在对象的角度去思考，如果把`普通课程``课程分类``链接`都当成独立的对象的话，在这里便会理所当然地分开展示。把两者混在一起，说明还是把对象混淆了。

## 情景三: 多种对象混在一起怎么办

这个跟情景二其实有关，由于情景二里设置了多种类型的跳转，导致在页面展示的时候出现了一个列表里有好几种对象的情况。

一开始我在想是不是产品设计得有问题，但是转念一想，这个需求存在的确是无法避免的。但是在实现的时候又极为别扭，一个列表里如果出现了十种对象，意味着需要去十个地方获取对象的信息，然后再进行展示。

而且这部分逻辑是交由Controller去处理的，而不是服务层做处理，所以Controller会因此多出来大量的业务逻辑代码，业务逻辑前移带来的是代码的重复、冗余。

换了个角度想了下，感觉还是找到了一个解决方法(不过并没有进行实践)。其实在情景二的时候我已经说漏嘴了，用户选择的是一个跳转对象，在这里可以提取出一个新的对象`跳转对象`，通过它再去访问对应的`课程对象`、`分类对象`、`链接对象`等，便能很好地把这部分业务逻辑控制在服务层。

当多种对象混在一起的时候，可以试着找下对象之间有没有什么共同点，是不是可以做下处理，当成一个对象呢?


